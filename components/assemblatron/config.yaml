#-Information---------------------------------------------------------------------------------------
name: assemblatron
category: &category De-novo Assembly
version: 2.0
schema_version: 2.0
target: sample
type: pipeline
recommendation: required
description: >
  This does de-novo assembly on a sample and then maps the reads back against the denovo assembly
  for variant calling. In the process it gathers metrics on many aspects for the use of QC. This
  generates the same metrics as qcquickie but should yield better contigs and it is recommended
  to use these contigs for downstream analysis.
#---------------------------------------------------------------------------------------------------

#-Docker location-----------------------------------------------------------------------------------
dockerfile: &dockerfile "docker://ssidk/bifrost-assemblatron:2.0"
#---------------------------------------------------------------------------------------------------

#-Options-------------------------------------------------------------------------------------------
options:
  cov_bin_values: [1, 10, 25]
#---------------------------------------------------------------------------------------------------

#-Required resource files---------------------------------------------------------------------------
# Relative files are relative to this components folder if not using an absolute path
adapters_fasta: "/bifrost_resources/adapters.fasta"
#---------------------------------------------------------------------------------------------------

#-Requirements to run component---------------------------------------------------------------------
requirements:
  sample:
    reads:
      R1:
      R2:
#-DB Value changes (excluding component output)-----------------------------------------------------
db_values_changes:
  files:
    - assemblatron/contigs.fasta
    - assemblatron/contigs.bin.cov
    - assemblatron/contigs.gff
    - assemblatron/contigs.pileup
    - assemblatron/contigs.sketch
    - assemblatron/contigs.stats
    - assemblatron/contigs.sum.cov
    - assemblatron/contigs.variants
  sample:
    properties:
      denovo_assembly:
        summary: # see sample_component summary
        component:
          _id: "ObjectId"
          _date: "datetime"
    reporter:
  sample_component:
      summary:
        bin_contigs_at_1x:
        bin_length_at_1x:
        bin_coverage_at_1x:
        bin_contigs_at_10x:
        bin_length_at_10x:
        bin_coverage_at_10x:
        bin_contigs_at_25x:
        bin_length_at_25x:
        bin_coverage_at_25x:
        raw_length_at_1x:
        raw_length_at_10x:
        raw_length_at_25x:
        filtered_reads_num:
        GC:
        N50:
        snp_filter_10x_10%:
        snp_filter_indels:
        snp_filter_deletions:
        raw_total_sequences:
        reads_mapped:
        reads_unmapped:
        insert_size_average:
        insert_size_standard_deviation:
#---------------------------------------------------------------------------------------------------
